var e,t=(function(e){var t=e.exports=function(e){return new n(e)};function n(e){this.value=e}function r(e,t,n){var r=[],u=[],f=!0;return function e(p){var s={},v=!0,h={node:n?o(p):p,node_:p,path:[].concat(r),parent:u[u.length-1],parents:u,key:r.slice(-1)[0],isRoot:0===r.length,level:r.length,circular:null,update:function(e,t){h.isRoot||(h.parent.node[h.key]=e),h.node=e,t&&(v=!1)},delete:function(e){delete h.parent.node[h.key],e&&(v=!1)},remove:function(e){a(h.parent.node)?h.parent.node.splice(h.key,1):delete h.parent.node[h.key],e&&(v=!1)},keys:null,before:function(e){s.before=e},after:function(e){s.after=e},pre:function(e){s.pre=e},post:function(e){s.post=e},stop:function(){f=!1},block:function(){v=!1}};if(!f)return h;function d(){if("object"==typeof h.node&&null!==h.node){h.keys&&h.node_===h.node||(h.keys=i(h.node)),h.isLeaf=0==h.keys.length;for(var e=0;e<u.length;e++)if(u[e].node_===p){h.circular=u[e];break}}else h.isLeaf=!0,h.keys=null;h.notLeaf=!h.isLeaf,h.notRoot=!h.isRoot}d();var y=t.call(h,h.node);return void 0!==y&&h.update&&h.update(y),s.before&&s.before.call(h,h.node),v?("object"!=typeof h.node||null===h.node||h.circular||(u.push(h),d(),l(h.keys,function(t,o){r.push(t),s.pre&&s.pre.call(h,h.node[t],t);var i=e(h.node[t]);n&&c.call(h.node,t)&&(h.node[t]=i.node),i.isLast=o==h.keys.length-1,i.isFirst=0==o,s.post&&s.post.call(h,i),r.pop()}),u.pop()),s.after&&s.after.call(h,h.node),h):h}(e).node}function o(e){if("object"==typeof e&&null!==e){var t;if(a(e))t=[];else if("[object Date]"===u(e))t=new Date(e.getTime?e.getTime():e);else if(function(e){return"[object RegExp]"===u(e)}(e))t=new RegExp(e);else if(function(e){return"[object Error]"===u(e)}(e))t={message:e.message};else if(function(e){return"[object Boolean]"===u(e)}(e))t=new Boolean(e);else if(function(e){return"[object Number]"===u(e)}(e))t=new Number(e);else if(function(e){return"[object String]"===u(e)}(e))t=new String(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=function(){};n.prototype=e.constructor&&e.constructor.prototype||e.__proto__||{},t=new n}return l(i(e),function(n){t[n]=e[n]}),t}return e}n.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var r=e[n];if(!t||!c.call(t,r)){t=void 0;break}t=t[r]}return t},n.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var r=e[n];if(!t||!c.call(t,r))return!1;t=t[r]}return!0},n.prototype.set=function(e,t){for(var n=this.value,r=0;r<e.length-1;r++){var o=e[r];c.call(n,o)||(n[o]={}),n=n[o]}return n[e[r]]=t,t},n.prototype.map=function(e){return r(this.value,e,!0)},n.prototype.forEach=function(e){return this.value=r(this.value,e,!1),this.value},n.prototype.reduce=function(e,t){var n=1===arguments.length,r=n?this.value:t;return this.forEach(function(t){this.isRoot&&n||(r=e.call(this,r,t))}),r},n.prototype.paths=function(){var e=[];return this.forEach(function(t){e.push(this.path)}),e},n.prototype.nodes=function(){var e=[];return this.forEach(function(t){e.push(this.node)}),e},n.prototype.clone=function(){var e=[],t=[];return function n(r){for(var u=0;u<e.length;u++)if(e[u]===r)return t[u];if("object"==typeof r&&null!==r){var a=o(r);return e.push(r),t.push(a),l(i(r),function(e){a[e]=n(r[e])}),e.pop(),t.pop(),a}return r}(this.value)};var i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};function u(e){return Object.prototype.toString.call(e)}var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)};l(i(n.prototype),function(e){t[e]=function(t){var r=[].slice.call(arguments,1),o=new n(t);return o[e].apply(o,r)}});var c=Object.hasOwnProperty||function(e,t){return t in e}}(e={exports:{}},e.exports),e.exports),n=/\s*(0|[1-9]+[0-9]*) (@[^@]+@ |)([A-Za-z0-9_]+)( [^\n\r]*|)/;function r(e){return function(t){return t.tag===e}}function o(e){var t,n=e.filter(r("INDI")).map(i),o=e.filter(r("FAM")),a=o.map(i),l=(t=[]).concat.apply(t,o.map(u)),c=n.concat(a),f=c.reduce(function(e,t,n){return e[t.id]=n,e},{});return{nodes:c,links:l=l.map(function(e){return function(t){return{source:e[t.source],target:e[t.target]}}}(f))}}function i(e){return e.id=e.pointer,e.name=function(e){if("INDI"===e.tag){var t=(e.tree.filter(r("NAME"))||[])[0];return t?t.data.replace(/\//g,""):"?"}return"Family"}(e),e}function u(e){return e.tree.filter(function(e){return e.data&&"@"===e.data[0]}).map(function(t){return{source:e.pointer,target:t.data}})}function a(e){var r={root:{tree:[]},level:0};return r.pointer=r.root,t(e.split("\n").map(function(e){var t=e.match(n);if(!t)return null;return{level:parseInt(t[1],10),pointer:t[2].trim(),tag:t[3].trim(),data:t[4].trim(),tree:[]}}).filter(function(e){return e}).reduce(function(e,t){if(t.level===e.level)e.pointer.tree.push(t);else if(t.level>e.level){var n=e.pointer;e.pointer=e.pointer.tree[e.pointer.tree.length-1],e.pointer.tree.push(t),e.pointer.up=n,e.level=t.level}else if(t.level<e.level){for(;t.level<=e.pointer.level&&e.pointer.up;)e.pointer=e.pointer.up;e.pointer.tree.push(t),e.level=t.level}return e},r).root.tree).map(function(e){delete e.up,delete e.level,this.update(e)})}export{o as d3ize,a as parse};
//# sourceMappingURL=index.m.js.map
